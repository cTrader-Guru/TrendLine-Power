<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">

    <style>
        label,
        a {
            font-size: 10px !important;
        }

        h5,
        input,
        button {
            font-size: 12px !important;
        }

        .column.panel:hover {
            border-radius: 5px;
            /*background-color: #d6d6d647;
            filter: none !important;*/
            background: rgba(232, 232, 232, 0.28) !important;
        }
    </style>

    <script type="text/javascript">

        // --> Evita la selezione del testo nella pagina
        function disableSelection(target) {

            if (typeof target.onselectstart != "undefined") { // --> IE

                target.onselectstart = function () { return false };

            } else if (typeof target.style.MozUserSelect != "undefined") { // --> Firefox

                target.style.MozUserSelect = "none";

            } else { // --> All

                target.onmousedown = function () { return false };

            }

            target.style.cursor = "default";

        }

        // --> IE fa cagare
        function isNumberKey(evt, ele) {

            var theEvent = evt || window.event;
            var key = theEvent.keyCode || theEvent.which;
            key = String.fromCharCode(key);
            var value = ele.value + key;
            var regex = /^\d+(,\d{0,2})?$/;
            if (!regex.test(value)) {
                theEvent.returnValue = false;
                if (theEvent.preventDefault) theEvent.preventDefault();
            }
        }

        function withOutSlashKey(evt, ele) {

            var theEvent = evt || window.event;
            var key = theEvent.keyCode || theEvent.which;
            key = String.fromCharCode(key);
            var value = ele.value + key;
            var regex = /\//;
            if (regex.test(value)) {
                theEvent.returnValue = false;
                if (theEvent.preventDefault) theEvent.preventDefault();
            }
        }

    </script>

</head>

<body class="">

    <div id="main" class="ui one column grid aligned left very padded" style="max-width: 380px;padding: 20px;">

        <div id="col1" class="column panel">

            <h5 class="ui header green">
                <i class="bell outline icon"></i>
                <div class="content">
                    Alert
                </div>
            </h5>

            <div class="ui form" style="padding-left: 30px;">
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="alert" value="di">
                            <label>Disabled</label>
                        </div>
                    </div>
                </div>
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="alert" value="ox">
                            <label>Over</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="alert" value="ob">
                            <label>Over Bar</label>
                        </div>
                    </div>
                </div>
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="alert" value="ux">
                            <label>Under</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="alert" value="ub">
                            <label>Under Bar</label>
                        </div>
                    </div>
                </div>

                <div class="fields">

                    <div class="sixteen wide field">
                        <label>Message</label>
                        <input type="text" id="message" name="message" onkeypress="return withOutSlashKey(event, this)" placeholder="{0}:Name; {1}:Cross; {2}:Ask; {3}:Bid">
                    </div>

                </div>

            </div>

        </div>

        <div class="column panel">

            <h5 class="ui header red">
                <i class="close icon"></i>
                <div class="content">
                    Close
                </div>
            </h5>

            <div class="ui form" style="padding-left: 30px;">
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="close" value="di">
                            <label>Disabled</label>
                        </div>
                    </div>
                </div>
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="close" value="ox">
                            <label>Over</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="close" value="ob">
                            <label>Over Bar</label>
                        </div>
                    </div>
                </div>

                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="close" value="ux">
                            <label>Under</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="close" value="ub">
                            <label>Under Bar</label>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <div class="column panel">

            <h5 class="ui header blue">
                <i class="shield icon"></i>
                <div class="content">
                    Open
                </div>
            </h5>

            <div class="ui form" style="padding-left: 30px;">
                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="di">
                            <label>Disabled</label>
                        </div>
                    </div>
                </div>

                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="bs">
                            <label>BuyStop</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="bb">
                            <label>BuyStop Bar</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="bl">
                            <label>BuyLimit</label>
                        </div>
                    </div>
                </div>

                <div class="inline fields">

                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="ss">
                            <label>SellStop</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="sb">
                            <label>SellStop Bar</label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui radio checkbox">
                            <input type="radio" name="open" value="sl">
                            <label>SellLimit</label>
                        </div>
                    </div>

                </div>

                <div class="fields">

                    <div class="field">
                        <label>Size</label>
                        <input type="text" id="size" name="size" onkeypress="return isNumberKey(event, this)">
                    </div>

                </div>
            </div>

        </div>

        <div class="column">

            <div class="ui grid">
                <div class="eight wide column left aligned bottom aligned">
                    <a id="version" href="#">cTrader Guru</a>
                </div>
                <div class="eight wide column right aligned">

                    <button id="save" class="ui primary button">
                        Save
                    </button>
                </div>
            </div>

        </div>

    </div>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

    <script>

        // --> Variabile globale per l'annidamento dei dati
        var setup = {

            alert: "di"
            , close: "di"
            , open: "di"
            , size: "0,01"
            , message : ""

        };

        $('.checkbox').checkbox({

            onChecked: function () {

                setup.alert = $('.checkbox').find('[name="alert"]:checked').val() || "di";
                setup.close = $('.checkbox').find('[name="close"]:checked').val() || "di";
                setup.open = $('.checkbox').find('[name="open"]:checked').val() || "di";

            }

        });

        $("#size").change(function () {

            setup.size = $(this).val() || "0,01";

        });

        $("#message").change(function () {

            setup.message = $(this).val();
            setup.message = setup.message.replaceAll("/", "");

        });

        $("#save").click(function () {

            window.external.Save(setup.alert + "/" + setup.close + "/" + setup.open + "/" + setup.size + "/" + setup.message.trim());

        });

        $("#version").click(function () {

            window.external.GoExternToPage();
            return false;

        });

        $(window).ready(function () {

            let comment = window.external.GetTrendComment();
            let splited = (comment && comment.trim().length > 0) ? comment.trim().split("/") : [];

            setup.alert = splited[0];
            setup.close = splited[1];
            setup.open = splited[2];
            setup.size = splited[3];
            setup.message = splited[4];

            $('input[name="alert"][value="' + setup.alert + '"]').attr("checked", "checked");
            $('input[name="close"][value="' + setup.close + '"]').attr("checked", "checked");
            $('input[name="open"][value="' + setup.open + '"]').attr("checked", "checked");
            $('#message').val(setup.message.trim());
            $('#size').val(setup.size);

        });

        // --> Disabilito la selezione del testo
        disableSelection(document.body);

    </script>

</body>

</html>